---
title: "Burnside 引理"
date: 2017-07-15 22:41:51
categories:
- 笔记
tags:
- 置换
---
阅读了 &lt;Pólya 计数法的应用&gt; 一文, 对里面的例题做一下笔记. &gt;_&lt;

- **[UVA 10601] Cubes** 用 12 根有颜色的等长棍子搭立方体, 旋转后颜色相同的方案算一种, 求方案数.
- **[SPOJ 419] [SPOJ 422] Transportation is fun** 给一个 2^a 2^b 的矩阵, 在内存中从上往下, 从左往右连续存放. 用交换操作求它的转置矩阵, 存储方式相同, 求最小步数.
- **[SGU 282] Isomorphism** 染色图是边带颜色的无向完全图. 求 N 个顶点, M 种颜色 (不必用完), 两两不同构的染色图个数模质数 P. (1 &le; N &le; 53, 1 &le; M &le; 1000, N &lt; P &le; 10^9)
<!--more-->

# Burnside 引理
$S$ 是待计数的对象的集合, $G$ 是置换群. 对于 $a,b\in S$, 如果存在 $f\in G$, 使得 $f(a) = b$, 则 $a,b$ 视为相同的对象. $S$ 中不同对象的数目 $L(S) = \frac {\sum_{f\in G} C(f)} {|G|}$. 其中 $C(f)$ 为 $S$ 中满足 $f(x)=x$ 的 $x$ (不动点) 的数目. $L(S)$ = 不动点数目的平均值.

考虑 $S$ 是格子的染色方案这种情形. 对置换做循环分解, 那么每个循环里的格子的颜色相同. 设用 $k$ 种颜色染色, $f$ 可以分解成 $m(f)$ 个循环, 则 $C(f) = k^{m(f)}$.

# [UVA 10601] Cubes
所有置换是三种基本置换的复合, 打个表, 发现共有 24 个, 按照循环的大小可分为以下 5 类:
```
1 1 1 1 1 1 1 1 1 1 1 1 (1 个)
1 1 2 2 2 2 2 (6 个)
2 2 2 2 2 2 (3 个)
3 3 3 3 (8 个)
4 4 4 (6 个)
```
除了第 2 类, 全都是相等的元素: 考察每种颜色用在哪里, 组合数计算方案数, 每种颜色的方案数相乘. 对于第 2 类, 先枚举一下哪两条边对应`1`.

如果没有这样的特征还不大好算......状压 DP.

# [SPOJ 419] [SPOJ 422] Transportation is fun
看起来不像等价类计数问题, 但是可以往这个方向转化.

原位置到目标位置的对应关系构成一个置换. 最优交换方式是直接换......对于一个长度为`l`的循环, 最少用`l-1`次交换使其复位. 设置换可以分解为`m`个循环, 则`ans = 2^(a+b) - m`.

地址和长度为 a+b 的 01 串一一对应. (i,j) 的地址为`i 2^b + j (0 <= i < 2^a, 0 <= j < 2^b)`, 可以看到其二进制表示就是`i的二进制表示 ++ j的二进制表示`, 高位用 0 补齐. 那么, (i,j) 变到 (j,i) 就是 01 串循环右移 b 位.

我们要求`(i,j) -> (j,i)`这个置换的循环的个数, 也就是在`循环右移 b 位`这个置换下等价类的数目. 可以用 Burnside 引理解决, 推导与`b=1`的情形类似, $m = \frac g {a+b} {\sum_{d\backslash a+b} 2^{gd} \varphi((a+b)/(gd))}$

# [SGU 282] Isomorphism
同构问题也是等价类计数问题. 我们借助较为简单的点的置换来考虑边的置换.

设一个点的置换 $f$ 分解为大小分别为 $x_1,x_2,\ldots,x_k$ 的循环. $f$ 和边的置换 $f'$ 一一对应. 我们关注的是 $f'$ 的循环的大小的构成.

一条边 $(i,j)$, 设 $i$ 在循环 $u$ 中, $j$ 在循环 $v$ 中, 那么 $(i',j') = f'(i,j)$ 同样满足 $i'\in u, j'\in v$. 所以, 我们可以分别考虑每个点置换的循环对的贡献.
- 两端点都在 $u$ 中的边构成的循环. $\lfloor \lvert u \rvert / 2 \rfloor$ 个, 每个对应一种 "边长".
- 端点分别在 $u,v (u\not=v)$ 中的边构成的循环. 一条边经过 $lcm(\lvert u \rvert, \lvert v \rvert)$ 次变换才回到原位, 即它所在循环的大小为 $lcm(\lvert u \rvert, \lvert v \rvert)$. 由对称性知循环有 $\lvert u \rvert \lvert v\rvert /lcm(\lvert u\rvert, \lvert v \rvert) = gcd(\lvert u \rvert, \lvert v\rvert)$ 个.

枚举 $u,v$, 现在我们可以在已知 $x_1,x_2,\ldots,x_k$ 的前提下计算 $f'$ 的循环的数目. 顶点数 $N$ 很小, 由对称性, 不妨枚举 $N$ 的拆分, 即 $x_1 \le x_2 \le \cdots x_k$. 需要求出每个拆分对应多少个点的置换. 先把循环看成两两不同的. 为每个点划分它归属的循环, 这是可重集的排列问题. 枚举循环的构成: 元素两两不同, 长度为 $l$ 的循环有 $(l-1)!$ 种构成. 如果 $x_i = x_{i+1} = \cdots = x_j$, 大小为 $x_i$ 的循环在 $[i,j]$ 上不同的排列方式之前被我们看成了不同的方案, 所以答案要除以 $(j-i+1)!$.

和 [UVA 10601] Cubes 的思想类似. 循环大小的构成相同的置换可以一起计算不动点的数目.
